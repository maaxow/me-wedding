<!DOCTYPE>
<html>
<head>
	<title>PhotoBooth</title>
	<link rel="stylesheet" href="/css/main.css">
	<script src="/vendor/angular/angular.min.js" charset="utf-8"></script>
</head>
<body>



	<div ng-app="app" ng-controller="AppController">
		<button href="" ng-click="getAll()">Refresh</button>
		<div>
			<div>
				<label for="first">Prénom</label>
				<input type="text" name="first" ng-model="newGuest.firstname"/>
			</div>
			<div>
				<label for="last">Nom</label>
				<input type="text" name="last" ng-model="newGuest.lastname"/>
			</div>
			<div>
				<label for="email">Email</label>
				<input type="email" name="email" ng-model="newGuest.email"/>
			</div>
			<div>
				<label for="phone">Telephone</label>
				<input type="tel" name="phone" ng-model="newGuest.phone_number"/>
			</div>
			<div>
				<label for="address">adresse</label>
				<input type="text" name="address" ng-model="newGuest.address"/>
			</div>
			<div>
				<label for="code">code postale</label>
				<input type="text" name="code" ng-model="newGuest.post_code"/>
			</div>
			<div>
				<label for="city">ville</label>
				<input type="text" name="city" ng-model="newGuest.city"/>
			</div>
			<div>
				<label for="country">Pays</label>
				<input type="text" name="country" ng-model="newGuest.country"/>
			</div>
			<div>
				<label for="present">Présent</label>
				<input type="radio" name="present" ng-checked="newGuest.present === 1"/> Oui
				<input type="radio" name="present" ng-checked="newGuest.present === 0"/> Non
			</div>
			<button ng-click="addGuest()">add</button> <!-- NEED ANGULAR TO USER http post -->
		</div>


			<table>
				<tr>
					<th>Prénom</th>
					<th>Nom</th>
					<th>Email</th>
					<th>Téléphone</th>
					<th>Adresse</th>
					<th>Code Postale</th>
					<th>Ville</th>
					<th>Pays</th>
					<th>Présent</th>
				</tr>
				<tr ng-repeat="guest in guests">
					<td>{{guest.firstname}}</td>
					<td>{{guest.lastname}}</td>
					<td>{{guest.email}}</td>
					<td>{{guest.phone_number}}</td>
					<td>{{guest.address}}</td>
					<td>{{guest.post_code}}</td>
					<td>{{guest.city}}</td>
					<td>{{guest.counrty}}</td>
					<td>{{guest.present}}</td>
				</tr>
			</table>
	</div>

	<script type="text/javascript">
		angular.module('app', []).controller('AppController', function($scope, $http){

			$scope.guests = [];
			$scope.newGuest = {
				firstname: '',
				lastname: '',
				email: '',
				phone_number: '',
				address: '',
				post_code: '',
				city: '',
				country: '',
				present: null
			};
			$scope.getAll = function(){
				console.log("calling getAll() ...");
				$http.get('/api/guest').then(function(data){
					console.log("getAll() : ", data);
					$scope.guests = data.data;
				});
			};
			$scope.getAll();

			$scope.addGuest = function(){
				$http.post('/api/guest', $scope.newGuest).then(function(data){
					console.log("addguest() : ", data);
					$scope.getAll();
				});
			};
		})
	</script>
</body>
</html>
